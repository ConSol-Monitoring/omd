#!/usr/bin/python3
# This script is part of OMD
# Joerg Linge 2010
#
import sys
import os

omd_config = {}
exec(compile(open('%s/etc/omd/site.conf' % os.environ['OMD_ROOT']).read(), '%s/etc/omd/site.conf' % os.environ['OMD_ROOT'], 'exec'), {}, omd_config)

sys.stdout.write("""#
# Do not edit this file. It will be recreated each time OMD
# is started or reloaded.
#
# execute 'omd reload crontab'
# to rebuild this file out of %(omd_root)s/etc/cron.d/*
#
# --ENVIRONMENT------------------------------------------------
SHELL=/bin/bash
BASH_ENV=%(omd_root)s/.profile
""" % {"omd_root": os.environ['OMD_ROOT']})

sys.stdout.write("OMD_ROOT=%s\n" % os.environ['OMD_ROOT'])
sys.stdout.write("OMD_SITE=%s\n" % os.environ['OMD_SITE'])
sys.stdout.write("PATH=%s\n" % os.environ['PATH'])
sys.stdout.write("PYTHONPATH=%s\n" % os.environ['PYTHONPATH'])
if "TZ" in os.environ:
    sys.stdout.write("CRON_TZ=%s\n" % os.environ['TZ'])
sys.stdout.write("MAILTO=\"%s\"\n" % omd_config.get('CONFIG_ADMIN_MAIL', os.environ['OMD_SITE']))
sys.stdout.write("# ------------------------------------------------------------\n")


for fn in sys.argv[1:]:
    sys.stdout.write("# %s\n" % (fn))
    for line in open(fn, "r"):
        sys.stdout.write(line)
    sys.stdout.write("# ------------------------------------------------------------\n")
